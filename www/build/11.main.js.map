{"version":3,"sources":["../../src/pages/comics/comics.module.ts","../../src/pages/comics/comics.ts"],"names":[],"mappings":"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","file":"11.main.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { ComicsPage } from './comics';\n\n@NgModule({\n  declarations: [\n    ComicsPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(ComicsPage),\n  ],\n  exports: [\n    ComicsPage\n  ]\n})\nexport class ComicsPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/comics/comics.module.ts","import { Component, ViewChild } from '@angular/core';\nimport { IonicPage, NavController, NavParams, Content } from 'ionic-angular';\nimport { pubilcService } from '../../service/public';\nimport { Headers, Http } from '@angular/http';\n\ndeclare var $: any;\ndeclare var document: any;\n@IonicPage()\n@Component({\n  selector: 'page-comics',\n  templateUrl: 'comics.html',\n})\nexport class ComicsPage {\n\n  @ViewChild(Content) content: Content;\n  name = '';\n  uptime = '-';\n  banner = '';\n  url = '';\n  len = '-';\n  cod = '0';\n  iclass = [];\n  dec = '';\n  olddata = [];\n  data = {\n    'pages': []\n  };\n  iscollect: boolean = false;\n  isrecord: boolean = false;\n  recordurl = '';\n  itimer = null;\n\n  constructor(\n    public navCtrl: NavController,\n    public navParams: NavParams,\n    public pubilcService: pubilcService,\n    public http: Http\n  ) {\n    this.name = this.navParams.get('name');\n    this.banner = this.navParams.get('banner');\n    this.url = this.navParams.get('url');\n    this.pubilcService.presentLoadingDefault();\n    if (this.pubilcService.user._id) {\n        this.checkcollect();\n      } else {\n        this.itimer = setTimeout(()=>{\n          clearTimeout(this.itimer);\n          this.init();\n        },300);\n      }\n  }\n\n  checkcollect() {\n\n\n    let url = \"http://www.devonhello.com/buka/checkcollect\";\n\n    var headers = new Headers();\n    headers.append('Content-Type', 'application/x-www-form-urlencoded');\n\n    this.http.post(url, \"bookname=\" + this.name + \"&uid=\" + this.pubilcService.user._id, {\n      headers: headers\n    })\n      .subscribe((res) => {\n        if (res.json().length != 0) {\n          this.iscollect = true;\n        }\n        this.getrecord();\n      });\n\n  }\n\n  //收藏\n  collect() {\n    if (this.pubilcService.user._id) {\n      this.pubilcService.presentLoadingDefault();\n      let url = \"http://www.devonhello.com/buka/collect\";\n\n      var headers = new Headers();\n      headers.append('Content-Type', 'application/x-www-form-urlencoded');\n\n      this.http.post(url, \"name=\" + this.pubilcService.user.nickname + \"&uid=\" + this.pubilcService.user._id + \"&bookname=\" + this.name + \"&bookbanner=\" + this.banner + \"&bookpages=\" + this.len + \"&booktime=\" + this.uptime + \"&url=\" + this.url, {\n        headers: headers\n      })\n        .subscribe((res) => {\n          this.pubilcService.presentLoadingDismiss();\n          if (res.json()['result']['ok'] == 1) {\n            this.iscollect = true; \n          }\n        });\n    } else {\n      this.navCtrl.push('LoginPage');\n    }\n  }\n\n  //取消收藏\n  uncollect() {\n    this.pubilcService.presentLoadingDefault();\n    let url = \"http://www.devonhello.com/buka/uncollect\";\n\n    var headers = new Headers();\n    headers.append('Content-Type', 'application/x-www-form-urlencoded');\n\n    this.http.post(url, \"uid=\" + this.pubilcService.user._id + \"&bookname=\" + this.name, {\n      headers: headers\n    })\n      .subscribe((res) => {\n        this.iscollect = false;\n        this.pubilcService.presentLoadingDismiss();\n      });\n  }\n\n  openpage(url) {\n    \n    if( this.pubilcService.user._id ){\n      this.addrecord(url);\n    }  \n\n    this.navCtrl.push('SeePage', {\n      url: url + '?p=1'\n    });\n  }\n\n\n  getrecord(){\n    let url = \"http://www.devonhello.com/buka/seerecord\";\n\n    var headers = new Headers();\n    headers.append('Content-Type', 'application/x-www-form-urlencoded');\n\n    this.http.post(url, \"bookname=\" + this.name + \"&uid=\" + this.pubilcService.user._id, {\n      headers: headers\n    })\n      .subscribe((res) => {\n        \n        if (res.json().length != 0) {\n          this.isrecord = true;\n          this.recordurl = res.json()[0]['url'];\n          this.isrecord = true;\n        }\n        this.init();\n      });\n  }\n\n\n  addrecord( iurl ){\n    let url = \"http://www.devonhello.com/buka/addrecord\";\n\n    var headers = new Headers();\n    headers.append('Content-Type', 'application/x-www-form-urlencoded');\n\n    this.http.post(url, \"uid=\" + this.pubilcService.user._id + \"&bookname=\" + this.name + \"&url=\" + iurl, {\n      headers: headers\n    })\n      .subscribe((res) => {\n        this.recordurl = iurl;\n      });\n  }\n\n  init() {\n\n    var _thst = this;\n    var link = $(\"<iframe/>\");\n    link.attr('id', 'ikmfs');\n    link.attr('src', this.url);\n    link.appendTo('body');\n\n\n    var oframe = $(\"#ikmfs\");\n    var pages = [];\n    oframe[0].onload = function () {\n\n      var ifobj = oframe.contents();\n      oframe[0].src = 'about:blank';\n      oframe.remove();\n\n      var ele = ifobj.find(\".chapter-list li a\");\n      _thst.banner = ifobj.find(\".thumb img\").attr('src');\n      _thst.dec = ifobj.find(\"#bookIntro\").text();\n      _thst.len = ifobj.find(\"dd\").eq(5).text();\n      _thst.cod = ifobj.find(\"dd\").eq(4).text();\n      _thst.uptime = ifobj.find(\"dd\").eq(6).text();\n      _thst.iclass = ifobj.find(\"dd\").eq(3).text().split('/');\n      ele.each(function () {\n        var iobj = {},\n          ot = $(this);\n        iobj['ititle'] = ot.attr('title');\n        iobj['ihref'] = ot.attr('href');\n        pages.push(iobj);\n      });\n      _thst.data['pages'] = pages;\n      _thst.pubilcService.presentLoadingDismiss();\n    };\n\n  }\n\n  ionViewWillLeave() {\n    var ifs = $(\"#ikmfs\");\n    ifs[0].src = 'about:blank';\n    ifs.remove();\n  }\n\n  //点击到顶部\n  tapEvent(e) {\n    this.content.scrollToTop();\n  }\n\n  ionViewDidEnter(){\n    if(this.pubilcService.user._id){\n      this.olddata = this.data['pages'];\n      this.data['pages'] = [];\n      this.data['pages'] = this.olddata\n    }\n    if(this.olddata.length == 0){\n      this.isrecord = true;\n    }\n  }\n\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/comics/comics.ts"],"sourceRoot":""}